<div class="container">
  <div class="forms-container">
      <div class="signin-signup">
          <form id="cpa-form" action="#" method="POST" class="sign-up-form">
            <h2 class="title">Đăng ký</h2>
            <div class="input-field">
              <i class="fas fa-user"></i>
              <input type="text" name="username" placeholder="Tên tài khoản" name="username" class="registerusername"/>
            </div>
            <div class="input-field">
              <i class="fas fa-envelope"></i>
              <input type="password" name="password" placeholder="Mật khẩu" name="password" class="registerpassword"/>
            </div>
            <div class="input-field">
              <i class="fas fa-lock"></i>
              <input type="password" name="return_password" placeholder="Nhập lại mật khẩu" class="retypepassword"/>
            </div>
            <input onclick="checkpasswordregister($('.registerpassword').val(),$('.retypepassword').val())"class="btn" value="Sign up" />
          </form>
      </div>
  </div>
  <div class="panels-container">
        <div class="panel right-panel">
          <div class="content">
            <h3>Bạn đã có tài khoản ?</h3>
            <p>
              Bấm vào nút đăng nhập để tiến hành đăng nhập tài khoản
            </p>
            <button onclick="window.location.href='/login'" class="btn transparent" id="sign-in-btn">
              Đăng nhập
            </button>
          </div>
          <img src="img/register.svg" class="image" alt="" />
        </div>
  </div>
</div>

<div id="toast"></div>

<script>
function checkpasswordregister(password,retypepassword){
    if(password === retypepassword){
      return  register();
    }
    return showToast('Thất bại!','Mật khẩu không trùng khớp','error');
}

function register(){
    $.ajax({
        url: '/register',
        type: 'POST',
        data: {
            username: $('.registerusername').val(),
            password: $('.registerpassword').val()
        }
    }).then(data => {
        showToast(data.title,data.message,data.type);
        setTimeout(function(){
            return window.location.replace("/login");
        },1000);
    }).catch(err =>{
        showToast(err.responseJSON.title,err.responseJSON.message,err.responseJSON.type);
    });
}
</script>